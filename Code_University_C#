Program.cs
using System;
using System.Windows.Forms;

namespace Электронный_университет
{
    static class Program
    {
        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new LoginForm());
        }
    }
}



LoginForm.cs
using System;
using System.Windows.Forms;

namespace Электронный_университет
{
    public partial class LoginForm : Form
    {
        public LoginForm()
        {
            InitializeComponent();
            this.MaximizeBox = false;
            this.MinimizeBox = false;
            this.FormBorderStyle = FormBorderStyle.FixedDialog;
            textBox1.Select();
        }

        string[][] txt = null;
        ini_func ini = new ini_func();



        private void button1_Click(object sender, EventArgs e)
        {
            int k = comboBox1.SelectedIndex;
            DB_connect con = new DB_connect(txt[k][1], txt[k][3], txt[k][4], txt[k][5]);
            if (con.CheckLogPass(textBox1.Text, textBox2.Text))
            {
                if (con.CheckRole(textBox1.Text) == "prof")
                {
                    this.Hide();
                    MainForm mf = new MainForm(textBox1.Text, txt[k][1], txt[k][3], txt[k][4], txt[k][5]);
                    mf.Show();
                }
                if (con.CheckRole(textBox1.Text) == "stud")
                {
                    this.Hide();
                    StudForm st = new StudForm(textBox1.Text, txt[k][1], txt[k][3], txt[k][4], txt[k][5]);
                    st.Show();
                }
            } else
            {
                MessageBox.Show("Неверные логин или пароль!");
            }
        }

        private void LoginForm_Load(object sender, EventArgs e)
        {
            txt = ini.ReadIni();
            for (int i = 0; i <= txt.Length - 1; i++)
            {
                comboBox1.Items.Add(txt[i][0]);
            }
            comboBox1.SelectedIndex = 0;
        }
    }
}



MainForm.cs
using System;
using System.Windows.Forms;
using MySql.Data.MySqlClient;

namespace Электронный_университет
{
    public partial class MainForm : Form
    {
        public MainForm(string login, string ip, string db, string user, string pass)
        {
            InitializeComponent();
            this.MaximizeBox = false;
            this.FormBorderStyle = FormBorderStyle.FixedDialog;
            this.login = login;
            this.ip = ip;
            this.db = db;
            this.user = user;
            this.pass = pass;
            connection = new DB_connect(ip, db, user, pass);
            this.dataGridView1.CellClick += DataGridView1_CellClick;
        }

        private void DataGridView1_CellClick(object sender, DataGridViewCellEventArgs e)
        {
            DataGridViewCell cell = dataGridView1.CurrentCell;
            if (!(cell.Value.ToString() == "") && (cell.ColumnIndex>0))
            {
                String[] stroke = cell.Value.ToString().Split(new string[] { "\r\n" }, StringSplitOptions.RemoveEmptyEntries);
                string group_name = stroke[1];
                string course_name = stroke[0];
                MySqlDataReader reader = connection.GetDBData("select * from course where name='" + course_name + "';");
                int course_id = 0;
                if (reader.Read())
                {
                    course_id = Convert.ToInt32(reader["id"]);
                }
                reader.Close();
                if (!(group_name == "") && !(course_id == 0))
                {
                    Progress pr = new Progress(group_name, course_id, ip, db, user, pass);
                    if (ini.FormOpened(pr))
                    {
                        Application.OpenForms[pr.Name].Focus();
                    }
                    else
                    {
                        pr.Show();
                    }
                }
            }
        }

        ini_func ini = new ini_func();
        private bool m_exit = true;
        public string login;
        public string ip;
        public string db;
        public string user;
        public string pass;
        int prof_id;
        DB_connect connection;

        private void label2_Click(object sender, EventArgs e)
        {
            Prepsched sched = new Prepsched(login, ip, db, user, pass);
            if (ini.FormOpened(sched))
            {
                Application.OpenForms[sched.Name].Show();
                Application.OpenForms[sched.Name].Focus();
            }
            else
            {
                sched.Show();
            }
        }

        private void label3_Click(object sender, EventArgs e)
        {
            Mu mu = new Mu(prof_id, ip, db, user, pass);
            if (ini.FormOpened(mu))
            {
                Application.OpenForms[mu.Name].Focus();
            }
            else
            {
                mu.Show();
            }
        }

        private void label5_Click(object sender, EventArgs e)
        {
            Ads ads = new Ads(prof_id, ip, db, user, pass);
            if (ini.FormOpened(ads))
            {
                Application.OpenForms[ads.Name].Focus();
            }
            else
            {
                ads.Show();
            }
        }

        private void MainForm_FormClosing(object sender, FormClosingEventArgs e)
        {
            if (m_exit)
            {
                DialogResult dialog = MessageBox.Show("Закрыть приложение?", "Закрыть", MessageBoxButtons.YesNo);
                if (dialog == DialogResult.Yes)
                {
                    m_exit = false;
                    Application.Exit();
                } else if (dialog == DialogResult.No)
                {
                    e.Cancel = true;
                }
            }
        }

        private void label4_Click(object sender, EventArgs e)
        {
            choose_pr pr = new choose_pr(prof_id, ip, db, user, pass);
            if (ini.FormOpened(pr))
            {
                Application.OpenForms[pr.Name].Focus();
            }
            else
            {
                pr.ShowDialog();
            }
        }

        private void MainForm_Load(object sender, EventArgs e)
        {
            
        }

        private void MainForm_Shown(object sender, EventArgs e)
        {
            dataGridView1.Rows.Clear();
            MySqlDataReader reader = connection.GetDBData("SELECT * FROM professor WHERE login='" + login + "';");
            reader.Read();
            label1.Text = reader["name"].ToString();
            prof_id = Convert.ToInt32(reader["id"]);
            reader.Close();
            string today = DateTime.Today.Year + "-" + DateTime.Today.Month + "-" + DateTime.Today.Day;
            reader = connection.GetDBData("select * from week where date_start<='" + today + "' and date_finish>='" + today + "';");
            string d_s;
            string d_f;
            int week_no = -1;
            if (reader.Read())
            {
                d_s = reader["date_start"].ToString();
                d_f = reader["date_finish"].ToString();
                week_no = Convert.ToInt32(reader["week_no"]);
            }
            reader.Close();
            int nechet;
            if (!(week_no == -1) && (week_no % 2 == 0))
            {
                nechet = 2; //знаменатель
            } else
            {
                nechet = 1; //числитель
            }
            reader = connection.GetDBData("select * from day_of_week where name='" + DateTime.Today.DayOfWeek.ToString() + "';");
            int day_of_week = 0;
            if (reader.Read())
            {
                day_of_week = Convert.ToInt32(reader["no"]);
            }
            reader.Close();
            reader = connection.GetDBData("select * from pairs");
            while (reader.Read())
            {
                dataGridView1.Rows.Add(reader["pair_no"]+": "+reader["time_start"]+"-"+ reader["time_finish"], "");
            }
            reader.Close();
            if (!(day_of_week == 0))
            {
                reader = connection.GetDBData("select * from schedule_on_week where parity='" + nechet + "' AND day_of_week='" + day_of_week + "' AND prof_id='" + prof_id + "';");
                while (reader.Read())
                {
                    foreach (DataGridViewRow row in dataGridView1.Rows)
                    {
                        if (row.Index == Convert.ToInt32(reader["pair_no"]))
                        {
                            row.Cells[1].Value = "";
                            DB_connect connection2 = new DB_connect(ip, db, user, pass);
                            MySqlDataReader reader2 = connection2.GetDBData("select * from course where id='" + reader["course_id"] + "';");
                            reader2.Read();
                            row.Cells[1].Value += reader2["name"] + "\r\n";
                            reader2.Close();
                            reader2 = connection2.GetDBData("select * from groups where name='" + reader["groups_name"] + "';");
                            reader2.Read();
                            row.Cells[1].Value += reader2["name"] + "\r\n";
                            reader2.Close();
                            row.Cells[1].Value += reader["classes_type_name"].ToString() + "\r\n";
                            row.Cells[1].Value += reader["auditory_no"].ToString();
                            row.Height = 65;
                        }
                    }
                }
            }
            reader.Close();
            
        }

        private void label7_Click(object sender, EventArgs e)
        {
            if (m_exit)
            {
                DialogResult dialog = MessageBox.Show("Закрыть приложение?", "Закрыть", MessageBoxButtons.YesNo);
                if (dialog == DialogResult.Yes)
                {
                    m_exit = false;
                    Application.Exit();
                }
                else if (dialog == DialogResult.No)
                {
                    ((FormClosingEventArgs)e).Cancel = true;
                }
            }
        }
    }
}



Prepsched.cs
using MySql.Data.MySqlClient;
using System;
using System.Windows.Forms;

namespace Электронный_университет
{
    public partial class Prepsched : Form
    {
        public Prepsched(string login, string ip, string db, string user, string pass)
        {
            InitializeComponent();
            this.MaximizeBox = false;
            this.FormBorderStyle = FormBorderStyle.FixedDialog;
            this.ip = ip;
            this.db = db;
            this.user = user;
            this.pass = pass;
            this.login = login;
            con = new DB_connect(ip, db, user, pass);
            string today = DateTime.Today.Year + "-" + DateTime.Today.Month + "-" + DateTime.Today.Day;
            reader = con.GetDBData("select * from week where date_start<='" + today + "' and date_finish>='" + today + "';");
            reader.Read();
            week = Convert.ToInt32(reader["week_no"]);
            reader.Close();
            this.dataGridView1.CellClick += DataGridView1_CellClick;
        }

        private void DataGridView1_CellClick(object sender, DataGridViewCellEventArgs e)
        {
            DataGridViewCell cell = dataGridView1.CurrentCell;
            if (!(cell.Value == null) && !(cell.Value.ToString() == "") && (cell.ColumnIndex > 0))
            {
                String[] stroke = cell.Value.ToString().Split(new string[] { "\r\n" }, StringSplitOptions.RemoveEmptyEntries);
                string group_name = stroke[1];
                string course_name = stroke[0];
                ini_func ini = new ini_func();
                DB_connect connection = new DB_connect(ip, db, user, pass);
                MySqlDataReader reader = connection.GetDBData("select * from course where name='" + course_name + "';");
                int course_id = 0;
                if (reader.Read())
                {
                    course_id = Convert.ToInt32(reader["id"]);
                }
                reader.Close();
                if (!(group_name == "") && !(course_id == 0))
                {
                    Progress pr = new Progress(group_name, course_id, ip, db, user, pass);
                    if (ini.FormOpened(pr))
                    {
                        Application.OpenForms[pr.Name].Focus();
                    }
                    else
                    {
                        pr.Show();
                    }
                }
            }
        }

        string ip;
        string db;
        string user;
        string pass;
        string login;
        int week;
        DB_connect con;
        MySqlDataReader reader;

        private void Upd(int week_no)
        {
            dataGridView1.Rows.Clear();
            reader = con.GetDBData("SELECT * FROM professor WHERE login='" + login + "';");
            reader.Read();
            label1.Text = reader["name"].ToString();
            int prof_id = Convert.ToInt32(reader["id"]);
            reader.Close();
            reader = con.GetDBData("select * from week where week_no='" + week_no + "';");
            if (reader.Read())
            {
                string[] d_s = reader["date_start"].ToString().Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);
                string[] d_f = reader["date_finish"].ToString().Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);
                textBox1.Text = d_s[0];
                textBox2.Text = d_f[0];
                reader.Close();
                int nechet;
                if (week_no % 2 == 0)
                {
                    nechet = 2;
                }
                else
                {
                    nechet = 1;
                }
                reader = con.GetDBData("select * from pairs");
                while (reader.Read())
                {
                    dataGridView1.Rows.Add(reader["pair_no"] + ": " + reader["time_start"] + "-" + reader["time_finish"]);
                }
                string group_name = "";
                for (int i = 1; i < 7; i++)
                {
                    DB_connect con2 = new DB_connect(ip, db, user, pass);
                    MySqlDataReader reader2 = con2.GetDBData("select * from schedule_on_week where (parity='" + nechet + "' or parity='0') and day_of_week='" + i + "' and prof_id='" + prof_id + "';");
                    while (reader2.Read())
                    {
                        int pair_no = Convert.ToInt32(reader2["pair_no"]);
                        group_name = reader2["groups_name"].ToString();
                        string classes_type_name = reader2["classes_type_name"].ToString();
                        int course_id = Convert.ToInt32(reader2["course_id"]);
                        int auditory = Convert.ToInt32(reader2["auditory_no"]);
                        DB_connect con3 = new DB_connect(ip, db, user, pass);
                        MySqlDataReader reader3 = con3.GetDBData("select * from course where id='" + course_id + "';");
                        reader3.Read();
                        string course_name = reader3["name"].ToString();
                        reader3.Close();
                        string str = course_name + "\r\n" + group_name + "\r\n" + classes_type_name + "\r\n" + auditory;
                        dataGridView1.Rows[pair_no - 1].Cells[i].Value = str;
                        dataGridView1.Rows[pair_no - 1].Height = 65;
                    }
                }
            }
            reader.Close();

        }

        private void Prepsched_Shown(object sender, EventArgs e)
        {
            
            Upd(week);
        }

        private void label2_Click(object sender, EventArgs e)
        {
            week -= 1;
            Upd(week);
        }

        private void label4_Click(object sender, EventArgs e)
        {
            week += 1;
            Upd(week);
        }
    }
}



Progress.cs
using System;
using System.Drawing;
using System.Windows.Forms;
using MySql.Data.MySqlClient;

namespace Электронный_университет
{
    public partial class Progress : Form
    {
        public Progress(string groups_name, int course_id, string ip, string db, string user, string pass)
        {
            InitializeComponent();
            this.MaximizeBox = false;
            this.FormBorderStyle = FormBorderStyle.FixedDialog;
            this.groups_name = groups_name;
            this.course_id = course_id;
            this.ip = ip;
            this.db = db;
            this.user = user;
            this.pass = pass;
            con = new DB_connect(ip, db, user, pass);
            this.listBox1.MouseDoubleClick += listBox1_MouseDoubleClick;
            this.dataGridView2.CellEndEdit += dataGridView2_labs;
            this.dataGridView3.CellEndEdit += dataGridView3_rk;
            this.dataGridView4.CellEndEdit += dataGridView4_dz;
            this.dataGridView1.CellEndEdit += dataGridView1_sems;
        }

        private void dataGridView1_sems(object sender, DataGridViewCellEventArgs e)
        {
            DataGridViewRow row = dataGridView1.CurrentRow;
            int c_id = Convert.ToInt32(dataGridView1.Columns[e.ColumnIndex].Name);
            DateTime dt = DateTime.Parse(dataGridView1.Columns[e.ColumnIndex].HeaderText);
            string date_time = String.Format("{0:yyyy-MM-dd}", dt);
            string name = row.Cells[0].Value.ToString();
            DB_connect con3 = new DB_connect(ip, db, user, pass);
            MySqlDataReader reader3;
            reader3 = con3.GetDBData("select * from students where name='" + name + "'");
            reader3.Read();
            string zk = reader3["zk"].ToString();
            reader3.Close();
            string value = "";
            if (!(dataGridView1.CurrentCell.Value == null))
            {
                value = dataGridView1.CurrentCell.Value.ToString();
            }
            if (value == "")
            {
                reader3 = con3.GetDBData("update attendance set attend='0', lateness='0', answer='0' where classes_id='"+c_id+"' and course_id='"+course_id+"' and st_zk_no='"+zk+"';");
            } else
            {
                int a = 0, l = 0, n = 0;
                if (value.Length > 3)
                {
                    MessageBox.Show("Ошибка ввода.", "Ошибка");
                    dataGridView1.CurrentCell.Value = "";
                    return;
                }
                else
                {
                    if (value.Contains("+"))
                    {
                        a = 1;
                    }
                    if (value.Contains("о") || value.Contains("o"))
                    {
                        l = 1;
                    }
                    if (value.Contains("д"))
                    {
                        n = 1;
                    }
                    reader3 = con3.GetDBData("update attendance set attend='"+a+"', lateness='"+l+"', answer='"+n+"' where classes_id='" + c_id + "' and course_id='" + course_id + "' and st_zk_no='" + zk + "';");
                }
            }
        }

        private void dataGridView4_dz(object sender, DataGridViewCellEventArgs e)
        {
            DB_connect cn = new DB_connect(ip, db, user, pass);
            MySqlDataReader reader2;
            if (dataGridView4.Columns[e.ColumnIndex].Name == "mark_dz")
            {
                DataGridViewRow row = dataGridView4.CurrentRow;
                DateTime dt = DateTime.Parse(row.Cells[1].Value.ToString());
                reader2 = cn.GetDBData("select * from classes where date='" + String.Format("{0:yyyy-MM-dd}", dt) + "' and course_id='" + course_id + "';");
                int class_id = -1;
                if (reader2.Read())
                {
                    class_id = Convert.ToInt32(reader2["id"]);
                    DB_connect cn2 = new DB_connect(ip, db, user, pass);
                    int value = 0;
                    if (!(row.Cells[3].Value == null))
                    {
                        value = Convert.ToInt32(row.Cells[3].Value);
                    }
                    MySqlDataReader rc = null;
                    if (value == 0)
                    {
                        rc = cn2.GetDBData("UPDATE classes_progress SET mark=null WHERE st_zk_no='" + zk + "' and course_id='" + course_id + "' and classes_id='" + class_id + "';");
                    } else
                    {
                        rc = cn2.GetDBData("UPDATE classes_progress SET mark='" + value + "' WHERE st_zk_no='" + zk + "' and course_id='" + course_id + "' and classes_id='" + class_id + "';");
                    }
                    rc.Read();
                    rc.Close();
                }
                reader2.Close();
            }

            if (dataGridView4.Columns[e.ColumnIndex].Name == "appear_dz")
            {
                DataGridViewRow row = dataGridView4.CurrentRow;
                DateTime dt = DateTime.Parse(row.Cells[1].Value.ToString());
                reader2 = cn.GetDBData("select * from classes where date='" + String.Format("{0:yyyy-MM-dd}", dt) + "' and course_id='" + course_id + "';");
                int class_id = -1;
                if (reader2.Read())
                {
                    class_id = Convert.ToInt32(reader2["id"]);
                    DB_connect cn2 = new DB_connect(ip, db, user, pass);
                    string tmp = "";
                    if (!(row.Cells[2].Value == null))
                    {
                        tmp = row.Cells[2].Value.ToString();
                    }
                    int att = 0;
                    if (tmp == "+")
                    {
                        att = 1;
                    } else
                    {
                        att = 0;
                    }
                    MySqlDataReader rc = cn2.GetDBData("UPDATE attendance SET attend='"+att+"' WHERE course_id='" + course_id + "' and classes_id='" + class_id + "' and st_zk_no='"+zk+"';");
                    rc.Read();
                    rc.Close();
                }
                reader2.Close();
            }
        }

        private void dataGridView3_rk(object sender, DataGridViewCellEventArgs e)
        {
            
            DB_connect cn = new DB_connect(ip, db, user, pass);
            MySqlDataReader reader2;
            if (dataGridView3.Columns[e.ColumnIndex].Name == "mark_rk")
            {
                DataGridViewRow row = dataGridView3.CurrentRow;
                DateTime dt = DateTime.Parse(row.Cells[1].Value.ToString());
                reader2 = cn.GetDBData("select * from classes where date='" + String.Format("{0:yyyy-MM-dd}", dt) + "' and course_id='" + course_id + "';");
                int class_id = -1;
                if (reader2.Read())
                {
                    class_id = Convert.ToInt32(reader2["id"]);
                    DB_connect cn2 = new DB_connect(ip, db, user, pass);
                    int value = 0;
                    if (!(row.Cells[3].Value == null))
                    {
                        value = Convert.ToInt32(row.Cells[3].Value);
                    }
                    MySqlDataReader rc = null;
                    if (value == 0)
                    {
                        rc = cn2.GetDBData("UPDATE classes_progress SET mark=null WHERE st_zk_no='" + zk + "' and course_id='" + course_id + "' and classes_id='" + class_id + "';");
                    }
                    else
                    {
                        rc = cn2.GetDBData("UPDATE classes_progress SET mark='" + value + "' WHERE st_zk_no='" + zk + "' and course_id='" + course_id + "' and classes_id='" + class_id + "';");
                    }
                    rc.Read();
                    rc.Close();
                }
                reader2.Close();
            }

            if (dataGridView3.Columns[e.ColumnIndex].Name == "appear_rk")
            {
                DataGridViewRow row = dataGridView3.CurrentRow;
                DateTime dt = DateTime.Parse(row.Cells[1].Value.ToString());
                reader2 = cn.GetDBData("select * from classes where date='" + String.Format("{0:yyyy-MM-dd}", dt) + "' and course_id='" + course_id + "';");
                int class_id = -1;
                if (reader2.Read())
                {
                    class_id = Convert.ToInt32(reader2["id"]);
                    DB_connect cn2 = new DB_connect(ip, db, user, pass);
                    string tmp = "";
                    if (!(row.Cells[2].Value == null))
                    {
                        tmp = row.Cells[2].Value.ToString();
                    }
                    int att = 0;
                    if (tmp == "+")
                    {
                        att = 1;
                    }
                    else
                    {
                        att = 0;
                    }
                    MySqlDataReader rc = cn2.GetDBData("UPDATE attendance SET attend='" + att + "' WHERE course_id='" + course_id + "' and classes_id='" + class_id + "' and st_zk_no='" + zk + "';");
                    rc.Read();
                    rc.Close();
                }
                reader2.Close();
            }
        }

        private void dataGridView2_labs(object sender, DataGridViewCellEventArgs e)
        {
            DB_connect cn = new DB_connect(ip, db, user, pass);
            MySqlDataReader reader2;
            if (dataGridView2.Columns[e.ColumnIndex].Name == "mark")
            {
                DataGridViewRow row = dataGridView2.CurrentRow;
                DateTime dt = DateTime.Parse(row.Cells[1].Value.ToString());
                reader2 = cn.GetDBData("select * from classes where date='" + String.Format("{0:yyyy-MM-dd}", dt) + "' and course_id='" + course_id + "';");
                int class_id = -1;
                if (reader2.Read())
                {
                    class_id = Convert.ToInt32(reader2["id"]);
                    DB_connect cn2 = new DB_connect(ip, db, user, pass);
                    int value = 0;
                    if (!(row.Cells[3].Value == null))
                    {
                        value = Convert.ToInt32(row.Cells[3].Value);
                    }
                    MySqlDataReader rc = null;
                    if (value == 0)
                    {
                        rc = cn2.GetDBData("UPDATE classes_progress SET mark=null WHERE st_zk_no='" + zk + "' and course_id='" + course_id + "' and classes_id='" + class_id + "';");
                    }
                    else
                    {
                        rc = cn2.GetDBData("UPDATE classes_progress SET mark='" + value + "' WHERE st_zk_no='" + zk + "' and course_id='" + course_id + "' and classes_id='" + class_id + "';");
                    }
                    rc.Read();
                    rc.Close();
                }
                reader2.Close();
            }

            if (dataGridView2.Columns[e.ColumnIndex].Name == "appear_lab")
            {
                DataGridViewRow row = dataGridView2.CurrentRow;
                DateTime dt = DateTime.Parse(row.Cells[1].Value.ToString());
                reader2 = cn.GetDBData("select * from classes where date='" + String.Format("{0:yyyy-MM-dd}", dt) + "' and course_id='" + course_id + "';");
                int class_id = -1;
                if (reader2.Read())
                {
                    class_id = Convert.ToInt32(reader2["id"]);
                    DB_connect cn2 = new DB_connect(ip, db, user, pass);
                    string tmp = "";
                    if (!(row.Cells[2].Value == null))
                    {
                        tmp = row.Cells[2].Value.ToString();
                    }
                    int att = 0;
                    if (tmp == "+")
                    {
                        att = 1;
                    }
                    else
                    {
                        att = 0;
                    }
                    MySqlDataReader rc = cn2.GetDBData("UPDATE attendance SET attend='" + att + "' WHERE course_id='" + course_id + "' and classes_id='" + class_id + "' and st_zk_no='" + zk + "';");
                    rc.Read();
                    rc.Close();
                }
                reader2.Close();
            }
        }

        string ip;
        string db;
        string user;
        string pass;
        string groups_name;
        int course_id;
        string zk;
        DB_connect con;
        MySqlDataReader reader;

        void listBox1_MouseDoubleClick(object sender, MouseEventArgs e)
        {
            {
                if (!(listBox1.SelectedItem == null))
                {
                    Lab_Upd(listBox1.SelectedItem.ToString());
                }
            }
        }

        private void Progress_Load(object sender, EventArgs e)
        {
        }

        private void Upd()
        {
            dataGridView1.Rows.Clear();
            dataGridView1.Columns.Clear();
            dataGridView2.Rows.Clear();
            dataGridView3.Rows.Clear();
            dataGridView4.Rows.Clear();
            dataGridView5.Rows.Clear();
            reader = con.GetDBData("select * from classes where classes_type_name='Семинар' AND course_id='" + course_id + "';");
            int days = 0;
            dataGridView1.Columns.Add("student", "Студент");
            dataGridView1.Columns[0].SortMode = DataGridViewColumnSortMode.NotSortable;
            dataGridView1.Columns[0].Resizable = DataGridViewTriState.False;
            dataGridView1.Columns[0].ReadOnly = true;
            dataGridView1.Columns[0].Width = 150;
            String[] stroke;
            int i = 1;
            while (reader.Read())
            {
                stroke = reader["date"].ToString().Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);
                string c_id = reader["id"].ToString();
                dataGridView1.Columns.Add(c_id, stroke[0].ToString());
                dataGridView1.Columns[i].Width = 65;
                dataGridView1.Columns[i].SortMode = DataGridViewColumnSortMode.NotSortable;
                dataGridView1.Columns[i].Resizable = DataGridViewTriState.False;
                string today = DateTime.Today.ToString();
                string date = reader["date"].ToString();
                if (!(date == today))
                {
                    dataGridView1.Columns[i].ReadOnly = true;
                    dataGridView1.Columns[i].DefaultCellStyle.ForeColor = DefaultForeColor;
                }
                else
                {
                    dataGridView1.Columns[i].ReadOnly = false;
                    dataGridView1.Columns[i].DefaultCellStyle.BackColor = Color.LightGreen;
                }
                i++;
            }
            days = i - 1;
            reader.Close();
            dataGridView1.Columns.Add("late", "Опозданий");
            dataGridView1.Columns[i].Width = 80;
            dataGridView1.Columns[i].SortMode = DataGridViewColumnSortMode.NotSortable;
            dataGridView1.Columns[i].Resizable = DataGridViewTriState.False;
            dataGridView1.Columns[i].ReadOnly = true;
            dataGridView1.Columns.Add("work", "Работа на семинарах");
            dataGridView1.Columns[i + 1].Width = 90;
            dataGridView1.Columns[i + 1].SortMode = DataGridViewColumnSortMode.NotSortable;
            dataGridView1.Columns[i + 1].Resizable = DataGridViewTriState.False;
            dataGridView1.Columns[i + 1].ReadOnly = true;
            reader = con.GetDBData("select * from students where groups_name='" + groups_name + "';");
            i = 0;
            while (reader.Read())
            {
                string name = reader["name"].ToString();
                string zk = reader["zk"].ToString();
                dataGridView1.Rows.Add(name);
                try
                {
                    int sum_late = 0;
                    int sum_answer = 0;
                    int k = 0;
                    for (int j = 1; j <= days; j++)
                    {
                        DB_connect con2 = new DB_connect(ip, db, user, pass);
                        MySqlDataReader reader2 = con2.GetDBData("select * from classes where classes_type_name='Семинар' AND course_id='" + course_id + "' and date='"+String.Format("{0:yyyy-MM-dd}", DateTime.Parse(dataGridView1.Columns[j].HeaderText))+"';");
                        int c_id = -1;
                        if (reader2.Read())
                        {
                            c_id = Convert.ToInt32(reader2["id"]);
                        }
                        reader2.Close();
                        reader2 = con2.GetDBData("select * from attendance where st_zk_no='" + zk + "' and course_id='" + course_id + "' and classes_id='"+c_id+"';");
                        reader2.Read();
                        dataGridView1.Rows[i].Cells[j].Value = "";

                        var attend = reader2["attend"].ToString();
                        var lateness = reader2["lateness"].ToString();
                        var answer = reader2["answer"].ToString();
                        string str = "";
                        if (attend == "True")
                        {
                            str += "+";
                        }
                        if (lateness == "True")
                        {
                            str += "о";
                            sum_late += 1;
                        }
                        if (answer == "True")
                        {
                            str += "д";
                            sum_answer += 1;
                        }
                        dataGridView1.Rows[i].Cells[j].Value = str;
                        k = j;
                        reader2.Close();
                    }
                    if (!(sum_late == 0))
                    {
                        dataGridView1.Rows[i].Cells[k + 1].Value = sum_late.ToString() + "/" + days;
                    } else
                    {
                        dataGridView1.Rows[i].Cells[k + 1].Value = "0/" + days;
                    }
                    if (!(sum_answer == 0))
                    {
                        dataGridView1.Rows[i].Cells[k + 2].Value = sum_answer.ToString() + "/" + days;
                    } else
                    {
                        dataGridView1.Rows[i].Cells[k + 2].Value = "0/" + days;
                    }

                    i++;
                }
                catch (Exception ex) {
                    MessageBox.Show(ex.ToString());
                }

            }
            reader.Close();
            listBox1.Items.Clear();
            DB_connect connect = new DB_connect(ip, db, user, pass);
            MySqlDataReader newread = connect.GetDBData("select * from students where groups_name='" + groups_name + "';");
            while (newread.Read())
            {
                listBox1.Items.Add(newread["name"].ToString());
            }
            newread.Close();
            connect.Close();
        }

        private void Lab_Upd(string name)
        {
            dataGridView2.Rows.Clear();
            dataGridView3.Rows.Clear();
            dataGridView4.Rows.Clear();
            DB_connect connect = new DB_connect(ip, db, user, pass);
            MySqlDataReader newread = connect.GetDBData("select * from students where name='" + name + "';");
            if (newread.Read())
            {
                zk = newread["zk"].ToString();
            }
            newread.Close();
            newread = connect.GetDBData("select * from classes where course_id='" + course_id + "' and classes_type_name='Лабораторная работа';");
            int[] lab_no = null;
            int[] lab_id = null;
            int i = 0;
            while (newread.Read())
            {
                Array.Resize(ref lab_no, i+1);
                lab_no[i] = Convert.ToInt32(newread["number"]);
                Array.Resize(ref lab_id, i+1);
                lab_id[i] = Convert.ToInt32(newread["id"]);
                dataGridView2.Rows.Add(lab_no[i].ToString());
                string[] stroke = newread["date"].ToString().Split(new string[] { " " }, StringSplitOptions.RemoveEmptyEntries);
                string s = stroke[0];
                dataGridView2.Rows[i].Cells[1].Value = stroke[0];
                DB_connect connect2 = new DB_connect(ip, db, user, pass);
                MySqlDataReader newread2 = connect2.GetDBData("select * from attendance where st_zk_no='" + zk + "' and course_id='" + course_id + "' and classes_id='" + lab_id[i] + "';");
                if (newread2.Read())
                {
                    bool attend = Convert.ToBoolean(newread2["attend"]);
                    if (attend)
                    {
                        dataGridView2.Rows[i].Cells[2].Value = "+";
                    }
                    DateTime late_date = DateTime.Parse(stroke[0]);
                    late_date = late_date.AddDays(7);
                    TimeSpan ts = DateTime.Today - late_date;
                    int days_left = ts.Days;
                    if (days_left > 7)
                    {
                        dataGridView2.Rows[i].Cells[4].Value = "+";
                    }
                }
                newread2.Close();
                newread2 = connect2.GetDBData("select * from classes_progress where st_zk_no='" + zk + "' and course_id='" + course_id + "' and classes_id='" + lab_id[i] + "';");
                if (newread2.Read())
                {
                    if (!(newread2["mark"]==System.DBNull.Value))
                    {
                        int mark = Convert.ToInt32(newread2["mark"]);
                        dataGridView2.Rows[i].Cells[3].Value = mark;
                    }
                }
                newread2.Close();

                i++;
            }
            newread.Close();
            newread = connect.GetDBData("select * from students where name='" + name + "';");
            if (newread.Read())
            {
                zk = newread["zk"].ToString();
            }
            newread.Close();
            newread = connect.GetDBData("select * from classes where course_id='" + course_id + "' and classes_type_name='Рубежный контроль';");
            lab_no = null;
            lab_id = null;
            i = 0;
            while (newread.Read())
            {
                Array.Resize(ref lab_no, i + 1);
                lab_no[i] = Convert.ToInt32(newread["number"]);
                Array.Resize(ref lab_id, i + 1);
                lab_id[i] = Convert.ToInt32(newread["id"]);
                dataGridView3.Rows.Add(lab_no[i].ToString());
                string[] stroke = newread["date"].ToString().Split(new string[] { " " }, StringSplitOptions.RemoveEmptyEntries);
                string s = stroke[0];
                dataGridView3.Rows[i].Cells[1].Value = stroke[0];
                DB_connect connect2 = new DB_connect(ip, db, user, pass);
                MySqlDataReader newread2 = connect2.GetDBData("select * from attendance where st_zk_no='" + zk + "' and course_id='" + course_id + "' and classes_id='" + lab_id[i] + "';");
                if (newread2.Read())
                {
                    bool attend = Convert.ToBoolean(newread2["attend"]);
                    if (attend)
                    {
                        dataGridView3.Rows[i].Cells[2].Value = "+";
                    }
                    DateTime late_date = DateTime.Parse(stroke[0]);
                    late_date = late_date.AddDays(7);
                    TimeSpan ts = DateTime.Today - late_date;
                    int days_left = ts.Days;
                    if (days_left > 7)
                    {
                        dataGridView3.Rows[i].Cells[4].Value = "+";
                    }
                }
                newread2.Close();
                newread2 = connect2.GetDBData("select * from classes_progress where st_zk_no='" + zk + "' and course_id='" + course_id + "' and classes_id='" + lab_id[i] + "';");
                if (newread2.Read() && !(newread2["mark"] == System.DBNull.Value))
                {
                    if (!(newread2["mark"] == System.DBNull.Value))
                    {
                        int mark = Convert.ToInt32(newread2["mark"]);
                        dataGridView3.Rows[i].Cells[3].Value = mark;
                    }
                }
                newread2.Close();

                i++;
            }
            newread.Close();
            newread = connect.GetDBData("select * from students where name='" + name + "';");
            if (newread.Read())
            {
                zk = newread["zk"].ToString();
            }
            newread.Close();
            newread = connect.GetDBData("select * from classes where course_id='" + course_id + "' and classes_type_name='Домашнее задание';");
            lab_no = null;
            lab_id = null;
            i = 0;
            while (newread.Read())
            {
                Array.Resize(ref lab_no, i + 1);
                lab_no[i] = Convert.ToInt32(newread["number"]);
                Array.Resize(ref lab_id, i + 1);
                lab_id[i] = Convert.ToInt32(newread["id"]);
                dataGridView4.Rows.Add(lab_no[i].ToString());
                string[] stroke = newread["date"].ToString().Split(new string[] { " " }, StringSplitOptions.RemoveEmptyEntries);
                string s = stroke[0];
                dataGridView4.Rows[i].Cells[1].Value = stroke[0];
                DB_connect connect2 = new DB_connect(ip, db, user, pass);
                MySqlDataReader newread2 = connect2.GetDBData("select * from attendance where st_zk_no='" + zk + "' and course_id='" + course_id + "' and classes_id='" + lab_id[i] + "';");
                if (newread2.Read())
                {
                    bool attend = Convert.ToBoolean(newread2["attend"]);
                    if (attend)
                    {
                        dataGridView4.Rows[i].Cells[2].Value = "+";
                    }
                    DateTime late_date = DateTime.Parse(stroke[0]);
                    late_date = late_date.AddDays(7);
                    TimeSpan ts = DateTime.Today - late_date;
                    int days_left = ts.Days;
                    if (days_left > 7)
                    {
                        dataGridView4.Rows[i].Cells[4].Value = "+";
                    }
                }
                newread2.Close();
                newread2 = connect2.GetDBData("select * from classes_progress where st_zk_no='" + zk + "' and course_id='" + course_id + "' and classes_id='" + lab_id[i] + "';");
                if (newread2.Read() && !(newread2["mark"] == System.DBNull.Value))
                {
                    if (!(newread2["mark"] == System.DBNull.Value))
                    {
                        int mark = Convert.ToInt32(newread2["mark"]);
                        dataGridView4.Rows[i].Cells[3].Value = mark;
                    }
                }
                newread2.Close();

                i++;
            }
            newread.Close();
        }
        
        public void exam_tab_update() 
        {
            dataGridView5.Rows.Clear();

            DB_connect con = new DB_connect(ip, db, user, pass);

            MySqlDataReader newread = con.GetDBData("select * from students where groups_name='" + groups_name + "';");
            int j = 1;
            int i = 0;
            string zk2 = "";
            while (newread.Read())
            {
                string st = newread["name"].ToString();
                dataGridView5.Rows.Add(st);
                zk2 = newread["zk"].ToString();
                DB_connect con2 = new DB_connect(ip, db, user, pass);
                MySqlDataReader newreader2 = con2.GetDBData("select * from classes_progress where st_zk_no='" + zk2 + "' and course_id='" + course_id + "';");
                int sum_mark = 0;
                while (newreader2.Read() && !(newreader2["mark"] == System.DBNull.Value))
                {
                    sum_mark += Convert.ToInt32(newreader2["mark"]);
                }
                dataGridView5.Rows[i].Cells[j+5].Value = sum_mark;
                newreader2.Close();

                newreader2 = con2.GetDBData("select * from attendance where st_zk_no='" + zk2 + "' and course_id='" + course_id + "';");
                int sum_late = 0;
                int sum_act = 0;
                int num = 0;
                while (newreader2.Read())
                {
                    string late = newreader2["attend"].ToString();
                    string act = newreader2["answer"].ToString();
                    if (late == "True")
                    {
                        sum_late++;
                    }
                    if (act == "True")
                    {
                        sum_act++;
                    }
                    num++;
                }
                dataGridView5.Rows[i].Cells[j+2].Value = sum_late + "/" + num;
                dataGridView5.Rows[i].Cells[j+3].Value = sum_act + "/" + num;
                newreader2.Close();

                newreader2 = con2.GetDBData("select * from classes where classes_type_name='Экзамен' and course_id='"+course_id+"';");
                int ekz_cl_id = 0;
                if (newreader2.Read())
                {
                    ekz_cl_id = Convert.ToInt32(newreader2["id"]);
                }
                newreader2.Close();

                newreader2 = con2.GetDBData("select * from classes_progress where st_zk_no='" + zk2 + "' and classes_id='" + ekz_cl_id + "' and course_id='" + course_id + "';");
                if (newreader2.Read())
                {
                    int mark = Convert.ToInt32(newreader2["mark"]);
                    dataGridView5.Rows[i].Cells[j+4].Value = mark;
                }
                newreader2.Close();
                i++;
            }
            newread.Close();

            newread = con.GetDBData("select * from modules where course_id='" + course_id + "';");
            i = 2;
            while (newread.Read())
            {
                int mod_id = Convert.ToInt32(newread["id"]);
                int mdl_id = Convert.ToInt32(newread["id"]);
                dataGridView5.Columns.Add("in_time" + (i / 2).ToString(), "В срок");
                dataGridView5.Columns["in_time" + (i / 2).ToString()].DisplayIndex = i;
                dataGridView5.Columns["in_time" + (i / 2).ToString()].ReadOnly = true;
                dataGridView5.Columns.Add("moudule" + (i / 2).ToString(), "Модуль " + (i / 2).ToString());
                dataGridView5.Columns["moudule" + (i / 2).ToString()].DisplayIndex = i;
                dataGridView5.Columns["moudule" + (i / 2).ToString()].ReadOnly = true;
                int col_id = dataGridView5.Columns["moudule" + (i / 2).ToString()].Index;

                for (int k = 0; k < dataGridView5.RowCount; k++)
                {
                    int mod_mark = 0;
                    DB_connect con3 = new DB_connect(ip, db, user, pass);
                    string st_n = dataGridView5.Rows[k].Cells[0].Value.ToString();
                    MySqlDataReader newreader2 = con3.GetDBData("select * from students where name='" + st_n + "';");
                    string zk = "";
                    if (newreader2.Read())
                    {
                        zk = newreader2["zk"].ToString();
                    }
                    newreader2.Close();
                    newreader2 = con3.GetDBData("select * from module_progress where course_id='" + course_id + "' and st_zk_no='" + zk + "' and module_id='" + mod_id + "';");
                    
                    if (newreader2.Read())
                    {
                        mod_mark = Convert.ToInt32(newreader2["summ_mark"]);
                    }
                    newreader2.Close();
                    if (!(mod_mark == 0))
                    {
                        dataGridView5.Rows[k].Cells[col_id].Value = mod_mark.ToString();
                    }
                    newreader2.Close();
                }
                i += 2;
            }
            newread.Close();
        }

        private void Progress_Shown(object sender, EventArgs e)
        {
            Upd();
            exam_tab_update();
        }
    }
}



Mu.cs
using System;
using System.Windows.Forms;
using MySql.Data.MySqlClient;

namespace Электронный_университет
{
    public partial class Mu : Form
    {
        public Mu(int prof_id, string ip, string db, string user, string pass)
        {
            InitializeComponent();
            this.MaximizeBox = false;
            this.FormBorderStyle = FormBorderStyle.FixedDialog;
            this.prof_id = prof_id;
            this.ip = ip;
            this.db = db;
            this.user = user;
            this.pass = pass;
            this.connection = new DB_connect(ip, db, user, pass);
            this.reader = connection.GetDBData("select * from professor where id='" + prof_id + "';");
            this.reader.Read();
            this.label1.Text = reader["name"].ToString();
            this.reader.Close();
        }
        int prof_id;
        string ip;
        string db;
        string user;
        string pass;
        DB_connect connection;
        MySqlDataReader reader;

        public void UpdMu()
        {
            dataGridView1.Rows.Clear();
            reader = connection.GetDBData("select * from mu where prof_id='" + prof_id.ToString() + "';");
            int i = 0;
            while (reader.Read())
            {
                int mu_id = Convert.ToInt32(reader["id"]);
                string comment = reader["comment"].ToString();
                int course_id = Convert.ToInt32(reader["course_id"]);
                int classes_id = Convert.ToInt32(reader["classes_id"]);
                string[] stroke = reader["date"].ToString().Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);
                string link = reader["link"].ToString();
                DB_connect cn = new DB_connect(ip, db, user, pass);
                MySqlDataReader reader2 = cn.GetDBData("select * from course where id='" + course_id.ToString() + "';");
                reader2.Read();
                string name = reader2["name"].ToString();
                reader2.Close();
                reader2 = cn.GetDBData("select * from classes where id='" + classes_id + "';");
                reader2.Read();
                string classes_type_name = reader2["classes_type_name"].ToString();
                string num = reader2["number"].ToString();
                string[] stroke2 = reader2["date"].ToString().Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);
                reader2.Close();
                reader2 = cn.GetDBData("select * from capacity where prof_id='" + prof_id + "' and course_id='" + course_id + "' and classes_id='" + classes_id + "';");
                string group_name = "";
                if (reader2.Read())
                {
                    group_name = reader2["groups_name"].ToString();
                }
                reader2.Close();
                dataGridView1.Rows.Add(mu_id, name, group_name, classes_type_name, num, stroke2[0], comment, link, stroke[0]);
                dataGridView1.Rows[i].Height = 80;
                i++; 
            }
            reader.Close();
        }

        private void Mu_Shown(object sender, EventArgs e)
        {
            UpdMu();
        }

        private void Mu_Load(object sender, EventArgs e)
        {
            UpdMu();
        }

        private void button3_Click_1(object sender, EventArgs e)
        {
            Add_mu mu = new Add_mu(0, "", prof_id, ip, db, user, pass);
            mu.ShowDialog();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            int count = dataGridView1.CurrentCell.RowIndex;
            DataGridViewRow row = dataGridView1.Rows[count];
            int mu_id = Convert.ToInt32(row.Cells[0].Value);
            string group_name = row.Cells[2].Value.ToString();
            Add_mu mu = new Add_mu(mu_id, group_name, prof_id, ip, db, user, pass);
            mu.ShowDialog();
        }

        private void button2_Click(object sender, EventArgs e)
        {
            int count = dataGridView1.CurrentCell.RowIndex;
            DataGridViewRow row = dataGridView1.Rows[count];
            int mu_id = Convert.ToInt32(row.Cells[0].Value);
            DialogResult dialog = MessageBox.Show("Удалить запись МУ №"+mu_id+"?", "Удаление", MessageBoxButtons.YesNo);
            if (dialog == DialogResult.Yes)
            {
                DB_connect con = new DB_connect(ip, db, user, pass);
                mu_id = Convert.ToInt32(row.Cells[0].Value);
                MySqlDataReader read = connection.GetDBData("delete from mu where id='" + mu_id + "'");
                read.Close();
                UpdMu();
            }
        }
    }
}




ChoosePr.cs
using System;
using System.Windows.Forms;
using MySql.Data.MySqlClient;

namespace Электронный_университет
{
    public partial class choose_pr : Form
    {
        public choose_pr(int prof_id, string ip, string db, string user, string pass)
        {
            InitializeComponent();
            this.MaximizeBox = false;
            this.MinimizeBox = false;
            this.FormBorderStyle = FormBorderStyle.FixedDialog;
            this.ip = ip;
            this.db = db;
            this.user = user;
            this.pass = pass;
            this.prof_id = prof_id;
            con = new DB_connect(ip, db, user, pass);
        }
        string ip;
        string db;
        string user;
        string pass;
        int prof_id;
        DB_connect con;
        MySqlDataReader reader;

        private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
        {

        }
        
        private void choose_pr_Load(object sender, EventArgs e)
        {
            reader = con.GetDBData("select * from capacity where prof_id='"+prof_id+"' group by groups_name;");
            while (reader.Read())
            {
                comboBox1.Items.Add(reader["groups_name"]);
            }
            reader.Close();
            reader = con.GetDBData("select * from capacity where prof_id='"+prof_id+ "' group by course_id;");
            while (reader.Read())
            {
                int id = Convert.ToInt32(reader["course_id"]);
                DB_connect con2 = new DB_connect(ip, db, user, pass);
                MySqlDataReader reader2 = con2.GetDBData("select * from course where id='"+id+"'");
                reader2.Read();
                comboBox2.Items.Add(reader2["name"]);
                reader2.Close();
            }
            reader.Close();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            if (!(comboBox1.SelectedItem == null) && !(comboBox2.SelectedItem == null))
            {
                string group_name = comboBox1.SelectedItem.ToString();
                reader = con.GetDBData("select * from course where name='" + comboBox2.SelectedItem.ToString() + "';");
                reader.Read();
                int course_id = Convert.ToInt32(reader["id"]);
                reader.Close();
                ini_func ini = new ini_func();
                Progress pr = new Progress(group_name, course_id, ip, db, user, pass);
                this.Close();
                if (ini.FormOpened(pr))
                {
                    Application.OpenForms[pr.Name].Focus();
                }
                else
                {
                    pr.Show();
                }
            } else
            {
                MessageBox.Show("Не выбрана группа или дисциплина!", "Ошибка");
            }
        }
    }
}



Ads.cs
using MySql.Data.MySqlClient;
using System;
using System.Windows.Forms;

namespace Электронный_университет
{
    public partial class Ads : Form
    {
        public Ads(int prof_id, string ip, string db, string user, string pass)
        {
            InitializeComponent();
            this.MaximizeBox = false;
            this.MinimizeBox = false;
            this.FormBorderStyle = FormBorderStyle.FixedDialog;
            this.prof_id = prof_id;
            this.ip = ip;
            this.db = db;
            this.user = user;
            this.pass = pass;
            this.prof_id = prof_id;
            con = new DB_connect(ip, db, user, pass);
            reader = con.GetDBData("select name from professor where id='" + prof_id + "';");
            reader.Read();
            prof_name = reader["name"].ToString();
            reader.Close();
            label1.Text = prof_name;
        }

        DB_connect con;
        MySqlDataReader reader;
        int prof_id;
        string prof_name;
        string ip;
        string db;
        string user;
        string pass;

        private void Ads_Shown(object sender, EventArgs e)
        {
            Upd();
        }

        public void Upd()
        {
            reader = con.GetDBData("select * from ads where prof_id='" + prof_id + "';");
            int i = 0;
            while (reader.Read())
            {
                DateTime dt = DateTime.Parse(reader["date"].ToString());
                string group_name = reader["groups_name"].ToString();
                string subject = reader["subject"].ToString();
                string text = reader["text"].ToString();
                dataGridView1.Rows.Add(String.Format("{0:dd.MM.yyyy}", dt), subject, text, group_name);
                dataGridView1.Rows[i].Height = 65;
                i++;
            }
            reader.Close();
        }

        private void button3_Click(object sender, EventArgs e)
        {
            Add_ad ads = new Add_ad(prof_id, ip, db, user, pass);
            ads.ShowDialog();
        }
    }
}



Add_mu.cs
using MySql.Data.MySqlClient;
using System;
using System.Windows.Forms;

namespace Электронный_университет
{
    public partial class Add_mu : Form
    {
        public Add_mu(int id, string group_name, int prof_id, string ip, string db, string user, string pass)
        {
            InitializeComponent();
            this.MaximizeBox = false;
            this.FormBorderStyle = FormBorderStyle.FixedDialog;
            this.id = id;
            this.ip = ip;
            this.db = db;
            this.user = user;
            this.pass = pass;
            this.prof_id = prof_id;
            this.group_name = group_name;
        }
        string group_name;
        int id;
        string ip;
        string db;
        string user;
        string pass;
        int prof_id;

        public void UpdMu(int id)
        {
            DB_connect cn = new DB_connect(ip, db, user, pass);
            MySqlDataReader reader;
            if (id == 0)
            {
                reader = cn.GetDBData("select * from capacity where prof_id='" + prof_id + "';");
                while (reader.Read())
                {
                    int course_id = Convert.ToInt32(reader["course_id"]);
                    int classes_id = Convert.ToInt32(reader["classes_id"]);
                    string groups_name = reader["groups_name"].ToString();
                    string course_name;

                    DB_connect con = new DB_connect(ip, db, user, pass);
                    MySqlDataReader reader2 = con.GetDBData("select * from course where id='" + course_id + "';");
                    if (reader2.Read())
                    {
                        course_name = reader2["name"].ToString();
                        if (comboBox1.FindString(course_name) == -1)
                        {
                            comboBox1.Items.Add(course_name);
                        }
                    }
                    reader2.Close();
                    if (comboBox2.FindString(groups_name) == -1)
                    {
                        comboBox2.Items.Add(groups_name);
                    }
                    reader2 = con.GetDBData("select * from classes_type;");
                    while (reader2.Read())
                    {
                        string cl_name = reader2["name"].ToString();
                        if (comboBox3.FindString(cl_name) == -1)
                        {
                            comboBox3.Items.Add(cl_name);
                        }
                    }
                    reader2.Close();
                }
                reader.Close();
            }
            else
            {
                reader = cn.GetDBData("select * from mu where id='" + id + "';");
                reader.Read();
                int course_id = Convert.ToInt32(reader["course_id"]);
                int classes_id = Convert.ToInt32(reader["classes_id"]);
                string comment = reader["comment"].ToString();
                string link = reader["link"].ToString();
                DateTime date = DateTime.Parse(reader["date"].ToString());
                reader.Close();
                // ----
                reader = cn.GetDBData("select name from course where id='"+course_id+"';");
                reader.Read();
                string course_name = reader["name"].ToString();
                reader.Close();
                reader = cn.GetDBData("select * from classes where id='"+classes_id+"' and course_id='"+course_id+"';");
                reader.Read();
                string cl_t_n = reader["classes_type_name"].ToString();
                int c_number = Convert.ToInt32(reader["number"]);
                reader.Close();

                comboBox1.Items.Add(course_name);
                comboBox1.SelectedItem = course_name;
                comboBox2.Items.Add(group_name);
                comboBox2.SelectedItem = group_name;
                comboBox3.Items.Add(cl_t_n);
                comboBox3.SelectedItem = cl_t_n;
                textBox1.Text = c_number.ToString();
                textBox2.Text = comment;
                textBox3.Text = link;
            }
        }

        private void button1_Click(object sender, EventArgs e)
        {
            
            if (comboBox1.SelectedItem == null)
            {
                MessageBox.Show("Вы не заполнили поле \"Дисциплина\"!");
                return;
            }
            string course_name = comboBox1.SelectedItem.ToString();
            if (comboBox2.SelectedItem == null)
            {
                MessageBox.Show("Вы не заполнили поле \"Группа\"!");
                return;
            }
            string group_name = comboBox2.SelectedItem.ToString();
            if (comboBox3.SelectedItem == null)
            {
                MessageBox.Show("Вы не заполнили поле \"Тип занятия\"!");
                return;
            }
            string cl_type = comboBox3.SelectedItem.ToString();
            if (textBox1.Text == "")
            {
                MessageBox.Show("Вы не заполнили поле \"Номер занятия\"!");
                return;
            }
            int cl_id = Convert.ToInt32(textBox1.Text);
            
            string comment = textBox2.Text;
            string link = textBox3.Text;
            DB_connect con2 = new DB_connect(ip, db, user, pass);
            MySqlDataReader reader2 = con2.GetDBData("select * from course where name='" + course_name + "';");
            int course_id = 0;
            if (reader2.Read())
            {
                course_id = Convert.ToInt32(reader2["id"]);
            }
            reader2.Close();
            reader2 = con2.GetDBData("select * from classes where id='" + cl_id + "' and course_id='" + course_id + "';");
            if (reader2.Read())
            {
                DB_connect con3 = new DB_connect(ip, db, user, pass);
                MySqlDataReader reader3;
                if (id == 0)
                {
                    reader3 = con3.GetDBData("insert into mu (classes_id, course_id, prof_id, comment, link, date) values ('" + cl_id + "', '" + course_id + "', '" + prof_id + "', '" + comment + "', '" + link + "', '" + String.Format("{0:yyyy-MM-dd}", DateTime.Today) + "');");
                    while (reader3.Read()) { }
                    MessageBox.Show("МУ успешно добавлено!", "Успех!");
                } else
                {
                    reader3 = con3.GetDBData("update mu set comment='" + comment + "', link='" + link + "' where id='" + id + "';");
                    while (reader3.Read()) { }
                    MessageBox.Show("МУ успешно обновлено!", "Успех!");
                }
                this.Close();
                Mu mu = Application.OpenForms["Mu"] as Mu;
                mu.UpdMu();
            }
            else
            {
                MessageBox.Show("Такого урока не существует!", "Ошибка.");
            }
        }

        private void Add_mu_Shown(object sender, EventArgs e)
        {
            UpdMu(id);
        }
    }
}



StudForm.cs
using MySql.Data.MySqlClient;
using System;
using System.Windows.Forms;

namespace Электронный_университет
{
    public partial class StudForm : Form
    {
        public StudForm(string login, string ip, string db, string user, string pass)
        {
            InitializeComponent();
            this.MaximizeBox = false;
            this.FormBorderStyle = FormBorderStyle.FixedDialog;
            this.login = login;
            this.ip = ip;
            this.db = db;
            this.user = user;
            this.pass = pass;
            connection = new DB_connect(ip, db, user, pass);
            dataGridView1.CellClick += DataGridView1_CellClick;
        }

        private void DataGridView1_CellClick(object sender, DataGridViewCellEventArgs e)
        {
            DataGridViewCell cell = dataGridView1.CurrentCell;
            if (!(cell.Value.ToString() == "") && (cell.ColumnIndex > 0))
            {
                String[] stroke = cell.Value.ToString().Split(new string[] { "\r\n" }, StringSplitOptions.RemoveEmptyEntries);
                string course_name = stroke[0];
                MySqlDataReader reader = connection.GetDBData("select * from course where name='" + course_name + "';");
                int course_id = 0;
                if (reader.Read())
                {
                    course_id = Convert.ToInt32(reader["id"]);
                }
                reader.Close();
                if (!(course_id == 0))
                {
                    StudProgress prog = new StudProgress(zk, group_name, ip, db, user, pass);
                    if (ini.FormOpened(prog))
                    {
                        Application.OpenForms[prog.Name].Show();
                        Application.OpenForms[prog.Name].Focus();
                    }
                    else
                    {
                        prog.Show();
                    }
                }
            }
        }

        public string login;
        public string ip;
        public string db;
        public string user;
        public string pass;
        DB_connect connection;
        string zk;
        string group_name;
        bool m_exit = true;
        ini_func ini = new ini_func();

        private void StudForm_Shown(object sender, EventArgs e)
        {
            connection = new DB_connect(ip, db, user, pass);
            MySqlDataReader reader = connection.GetDBData("SELECT * FROM students WHERE login='" + login + "';");
            reader.Read();
            label1.Text = reader["name"].ToString();
            group_name = reader["groups_name"].ToString();
            zk = reader["zk"].ToString();
            reader.Close();
            string today = DateTime.Today.Year + "-" + DateTime.Today.Month + "-" + DateTime.Today.Day;
            reader = connection.GetDBData("select * from week where date_start<='" + today + "' and date_finish>='" + today + "';");
            string d_s;
            string d_f;
            int week_no = -1;
            if (reader.Read())
            {
                d_s = reader["date_start"].ToString();
                d_f = reader["date_finish"].ToString();
                week_no = Convert.ToInt32(reader["week_no"]);
            }
            reader.Close();
            int nechet;
            if (!(week_no == -1) && (week_no % 2 == 0))
            {
                nechet = 2; //знаменатель
            }
            else
            {
                nechet = 1; //числитель
            }
            reader = connection.GetDBData("select * from day_of_week where name='" + DateTime.Today.DayOfWeek.ToString() + "';");
            int day_of_week = 0;
            if (reader.Read())
            {
                day_of_week = Convert.ToInt32(reader["no"]);
            }
            reader.Close();
            reader = connection.GetDBData("select * from pairs");
            while (reader.Read())
            {
                dataGridView1.Rows.Add(reader["pair_no"] + ": " + reader["time_start"] + "-" + reader["time_finish"], "");
            }
            reader.Close();
            
            if (!(day_of_week == 0))
            {
                reader = connection.GetDBData("select * from schedule_on_week where parity='" + nechet + "' AND day_of_week='" + day_of_week + "' AND groups_name='" + group_name + "';");
                while (reader.Read())
                {
                    foreach (DataGridViewRow row in dataGridView1.Rows)
                    {
                        if (row.Index == Convert.ToInt32(reader["pair_no"]))
                        {
                            row.Cells[1].Value = "";
                            DB_connect connection2 = new DB_connect(ip, db, user, pass);
                            MySqlDataReader reader2 = connection2.GetDBData("select * from course where id='" + reader["course_id"] + "';");
                            reader2.Read();
                            row.Cells[1].Value += reader2["name"] + "\r\n";
                            reader2.Close();
                            reader2 = connection2.GetDBData("select * from professor where id='" + reader["prof_id"] + "';");
                            reader2.Read();
                            row.Cells[1].Value += reader2["name"] + "\r\n";
                            reader2.Close();
                            row.Cells[1].Value += reader["classes_type_name"] + "\r\n";
                            row.Cells[1].Value += reader["auditory_no"].ToString();
                            row.Height = 65;
                        }
                    }
                }
            }
            reader.Close();
        }

        private void label7_Click(object sender, EventArgs e)
        {
            if (m_exit)
            {
                DialogResult dialog = MessageBox.Show("Закрыть приложение?", "Закрыть", MessageBoxButtons.YesNo);
                if (dialog == DialogResult.Yes)
                {
                    m_exit = false;
                    Application.Exit();
                }
                else if (dialog == DialogResult.No)
                {
                    ((FormClosingEventArgs)e).Cancel = true;
                }
            }
        }

        private void label2_Click(object sender, EventArgs e)
        {
            StudSched ssh = new StudSched(label1.Text, group_name, ip, db, user, pass);
            if (ini.FormOpened(ssh))
            {
                Application.OpenForms[ssh.Name].Show();
                Application.OpenForms[ssh.Name].Focus();
            }
            else
            {
                ssh.Show();
            }
        }

        private void label3_Click(object sender, EventArgs e)
        {
            StudMu mu = new StudMu(label1.Text, ip, db, user, pass);
            if (ini.FormOpened(mu))
            {
                Application.OpenForms[mu.Name].Focus();
            }
            else
            {
                mu.Show();
            }
        }

        private void label4_Click(object sender, EventArgs e)
        {
            StudProgress prog = new StudProgress(zk, group_name, ip, db, user, pass);
            if (ini.FormOpened(prog))
            {
                Application.OpenForms[prog.Name].Show();
                Application.OpenForms[prog.Name].Focus();
            }
            else
            {
                prog.Show();
            }
        }

        private void StudForm_FormClosing(object sender, FormClosingEventArgs e)
        {
            if (m_exit)
            {
                DialogResult dialog = MessageBox.Show("Закрыть приложение?", "Закрыть", MessageBoxButtons.YesNo);
                if (dialog == DialogResult.Yes)
                {
                    m_exit = false;
                    Application.Exit();
                }
                else if (dialog == DialogResult.No)
                {
                    e.Cancel = true;
                }
            }
        }

        private void label5_Click(object sender, EventArgs e)
        {
            StudAds ads = new StudAds();
            ads.Show();
        }
    }
}



StudAds.cs
using MySql.Data.MySqlClient;
using System;
using System.Windows.Forms;

namespace Электронный_университет
{
    public partial class Ads : Form
    {
        public Ads(int prof_id, string ip, string db, string user, string pass)
        {
            InitializeComponent();
            this.MaximizeBox = false;
            this.MinimizeBox = false;
            this.FormBorderStyle = FormBorderStyle.FixedDialog;
            this.prof_id = prof_id;
            this.ip = ip;
            this.db = db;
            this.user = user;
            this.pass = pass;
            this.prof_id = prof_id;
            con = new DB_connect(ip, db, user, pass);
            reader = con.GetDBData("select name from professor where id='" + prof_id + "';");
            reader.Read();
            prof_name = reader["name"].ToString();
            reader.Close();
            label1.Text = prof_name;
        }

        DB_connect con;
        MySqlDataReader reader;
        int prof_id;
        string prof_name;
        string ip;
        string db;
        string user;
        string pass;

        private void Ads_Shown(object sender, EventArgs e)
        {
            Upd();
        }

        public void Upd()
        {
            reader = con.GetDBData("select * from ads where prof_id='" + prof_id + "';");
            int i = 0;
            while (reader.Read())
            {
                DateTime dt = DateTime.Parse(reader["date"].ToString());
                string group_name = reader["groups_name"].ToString();
                string subject = reader["subject"].ToString();
                string text = reader["text"].ToString();
                dataGridView1.Rows.Add(String.Format("{0:dd.MM.yyyy}", dt), subject, text, group_name);
                dataGridView1.Rows[i].Height = 65;
                i++;
            }
            reader.Close();
        }

        private void button3_Click(object sender, EventArgs e)
        {
            Add_ad ads = new Add_ad(prof_id, ip, db, user, pass);
            ads.ShowDialog();
        }
    }
}



StudMu.cs
using MySql.Data.MySqlClient;
using System;
using System.Windows.Forms;

namespace Электронный_университет
{
    public partial class StudMu : Form
    {
        public StudMu(string name, string ip, string db, string user, string pass)
        {
            InitializeComponent();
            this.MaximizeBox = false;
            this.FormBorderStyle = FormBorderStyle.FixedDialog;
            this.ip = ip;
            this.db = db;
            this.user = user;
            this.pass = pass;
            this.connection = new DB_connect(ip, db, user, pass);
            label1.Text = name;
        }
        string ip;
        string db;
        string user;
        string pass;
        DB_connect connection;
        MySqlDataReader reader;

        private void updMu()
        {
            reader = connection.GetDBData("select * from mu;");
            while (reader.Read())
            {
                int course_id = Convert.ToInt32(reader["course_id"]);
                int classes_id = Convert.ToInt32(reader["classes_id"]);
                int prof_id = Convert.ToInt32(reader["prof_id"]);
                string comment = reader["comment"].ToString();
                string link = reader["link"].ToString();
                DateTime dt = DateTime.Parse(reader["date"].ToString());
                DateTime dt_cl = new DateTime();
                string crs_name = "";
                string prf_name = "";
                string classes_type_name = "";
                int number = 0;

                DB_connect con = new DB_connect(ip, db, user, pass);
                MySqlDataReader reader2 = con.GetDBData("select * from course where id='" + course_id + "';");
                if (reader2.Read())
                {
                    crs_name = reader2["name"].ToString();
                }
                reader2.Close();
                reader2 = con.GetDBData("select * from professor where id='" + prof_id + "';");
                if (reader2.Read())
                {
                    prf_name = reader2["name"].ToString();
                }
                reader2.Close();
                reader2 = con.GetDBData("select * from classes where id='" + classes_id + "' and course_id='" + course_id + "';");
                if (reader2.Read())
                {
                    classes_type_name = reader2["classes_type_name"].ToString();
                    dt_cl = DateTime.Parse(reader["date"].ToString());
                }
                reader2.Close();
                dataGridView1.Rows.Add(crs_name, prf_name, classes_type_name, "", String.Format("{0:dd.MM.yyyy}", dt_cl), comment, link, String.Format("{0:dd.MM.yyyy}", dt));
                dataGridView1.Rows[dataGridView1.Rows.Count - 1].Height = 75;
            }
        }

        private void StudMu_Shown(object sender, EventArgs e)
        {
            updMu();
        }
    }
}



StudProgress.cs
using MySql.Data.MySqlClient;
using System;
using System.Windows.Forms;

namespace Электронный_университет
{
    public partial class StudProgress : Form
    {
        public StudProgress(string zk, string group_name, string ip, string db, string user, string pass)
        {
            InitializeComponent();
            this.MaximizeBox = false;
            this.FormBorderStyle = FormBorderStyle.FixedDialog;
            this.group_name = group_name;
            this.ip = ip;
            this.db = db;
            this.user = user;
            this.pass = pass;
            this.zk = zk;
            this.listBox1.MouseDoubleClick += listBox1_MouseDoubleClick;
            this.comboBox1.SelectedIndexChanged += ComboBox1_SelectedIndexChanged;
        }

        private void ComboBox1_SelectedIndexChanged(object sender, EventArgs e)
        {
            con = new DB_connect(ip, db, user, pass);
            reader = con.GetDBData("select * from course where name='" + comboBox1.SelectedItem.ToString() + "'");
            reader.Read();
            int crs = Convert.ToInt32(reader["id"]);
            reader.Close();
            Upd1(crs, comboBox1.SelectedItem.ToString());
        }

        private void listBox1_MouseDoubleClick(object sender, MouseEventArgs e)
        {
            if (!(listBox1.SelectedItem == null))
            {
                con = new DB_connect(ip, db, user, pass);
                MySqlDataReader reader2 = con.GetDBData("select * from course where name='" + listBox1.SelectedItem.ToString() + "'");
                reader2.Read();
                int crs = Convert.ToInt32(reader2["id"]);
                reader2.Close();
                labs(crs);
            }
        }

        string ip;
        string db;
        string user;
        string pass;
        string group_name;
        string zk;
        DB_connect con;
        MySqlDataReader reader;

        private void Upd1(int course_id, string course_name)
        {
            dataGridView1.Rows.Clear();
            dataGridView1.Columns.Clear();
            reader = con.GetDBData("select * from classes where classes_type_name='Семинар' AND course_id='" + course_id + "';");
            int days = 0;
            dataGridView1.Columns.Add("discipline", course_name);
            dataGridView1.Columns[0].SortMode = DataGridViewColumnSortMode.NotSortable;
            dataGridView1.Columns[0].Resizable = DataGridViewTriState.False;
            dataGridView1.Columns[0].ReadOnly = true;
            dataGridView1.Columns[0].Width = 150;
            String[] stroke;
            int i = 1;
            while (reader.Read())
            {
                stroke = reader["date"].ToString().Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);
                string c_id = reader["id"].ToString();
                dataGridView1.Columns.Add(c_id, stroke[0].ToString());
                dataGridView1.Columns[i].Width = 65;
                dataGridView1.Columns[i].SortMode = DataGridViewColumnSortMode.NotSortable;
                dataGridView1.Columns[i].Resizable = DataGridViewTriState.False;
                dataGridView1.Columns[i].ReadOnly = true;
                i++;
            }
            days = i - 1;
            reader.Close();
            dataGridView1.Columns.Add("late", "Опозданий");
            dataGridView1.Columns[i].Width = 80;
            dataGridView1.Columns[i].SortMode = DataGridViewColumnSortMode.NotSortable;
            dataGridView1.Columns[i].Resizable = DataGridViewTriState.False;
            dataGridView1.Columns[i].ReadOnly = true;
            dataGridView1.Columns.Add("work", "Работа на семинарах");
            dataGridView1.Columns[i + 1].Width = 90;
            dataGridView1.Columns[i + 1].SortMode = DataGridViewColumnSortMode.NotSortable;
            dataGridView1.Columns[i + 1].Resizable = DataGridViewTriState.False;
            dataGridView1.Columns[i + 1].ReadOnly = true;
            i = 0;
            dataGridView1.Rows.Add("---");
                try
                {
                    int sum_late = 0;
                    int sum_answer = 0;
                    int k = 0;
                    for (int j = 1; j <= days; j++)
                    {
                        DB_connect con2 = new DB_connect(ip, db, user, pass);
                        MySqlDataReader reader2 = con2.GetDBData("select * from classes where classes_type_name='Семинар' AND course_id='" + course_id + "' and date='" + String.Format("{0:yyyy-MM-dd}", DateTime.Parse(dataGridView1.Columns[j].HeaderText)) + "';");
                        int c_id = -1;
                        if (reader2.Read())
                        {
                            c_id = Convert.ToInt32(reader2["id"]);
                        }
                        reader2.Close();
                        reader2 = con2.GetDBData("select * from attendance where st_zk_no='" + zk + "' and course_id='" + course_id + "' and classes_id='" + c_id + "';");
                        reader2.Read();
                        dataGridView1.Rows[i].Cells[j].Value = "";
                        dataGridView1.Rows[i].Height = 50;

                        var attend = reader2["attend"].ToString();
                        var lateness = reader2["lateness"].ToString();
                        var answer = reader2["answer"].ToString();
                        string str = "";
                        if (attend == "True")
                        {
                            str += "+";
                        }
                        if (lateness == "True")
                        {
                            str += "о";
                            sum_late += 1;
                        }
                        if (answer == "True")
                        {
                            str += "д";
                            sum_answer += 1;
                        }
                        dataGridView1.Rows[i].Cells[j].Value = str;
                        k = j;
                        reader2.Close();
                    }
                    if (!(sum_late == 0))
                    {
                        dataGridView1.Rows[i].Cells[k + 1].Value = sum_late.ToString() + "/" + days;
                    }
                    else
                    {
                        dataGridView1.Rows[i].Cells[k + 1].Value = "0/" + days;
                    }
                    if (!(sum_answer == 0))
                    {
                        dataGridView1.Rows[i].Cells[k + 2].Value = sum_answer.ToString() + "/" + days;
                    }
                    else
                    {
                        dataGridView1.Rows[i].Cells[k + 2].Value = "0/" + days;
                    }

                    i++;
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.ToString());
                }
            
        }

        private void Upd()
        {
            listBox1.Items.Clear();
            DB_connect connect = new DB_connect(ip, db, user, pass);
            MySqlDataReader newread = connect.GetDBData("select * from capacity where groups_name='" + group_name + "' group by course_id;");
            while (newread.Read())
            {
                string course_id = newread["course_id"].ToString();
                DB_connect connect2 = new DB_connect(ip, db, user, pass);
                MySqlDataReader reader2 = connect2.GetDBData("select * from course where id='" + course_id + "';");
                reader2.Read();
                listBox1.Items.Add(reader2["name"].ToString());
                comboBox1.Items.Add(reader2["name"].ToString());
            }
            newread.Close();
            connect.Close();
        }

        private void labs(int crs)
        {
            dataGridView2.Rows.Clear();
            dataGridView3.Rows.Clear();
            dataGridView4.Rows.Clear();
            DB_connect connect = new DB_connect(ip, db, user, pass);
            MySqlDataReader newread = connect.GetDBData("select * from classes where course_id='" + crs + "' and classes_type_name='Лабораторная работа';");
            int[] lab_no = null;
            int[] lab_id = null;
            int i = 0;
            while (newread.Read())
            {
                Array.Resize(ref lab_no, i + 1);
                lab_no[i] = Convert.ToInt32(newread["number"]);
                Array.Resize(ref lab_id, i + 1);
                lab_id[i] = Convert.ToInt32(newread["id"]);
                dataGridView2.Rows.Add(lab_no[i].ToString());
                string[] stroke = newread["date"].ToString().Split(new string[] { " " }, StringSplitOptions.RemoveEmptyEntries);
                string s = stroke[0];
                dataGridView2.Rows[i].Cells[1].Value = stroke[0];
                DB_connect connect2 = new DB_connect(ip, db, user, pass);
                MySqlDataReader newread2 = connect2.GetDBData("select * from attendance where st_zk_no='" + zk + "' and course_id='" + crs + "' and classes_id='" + lab_id[i] + "';");
                if (newread2.Read())
                {
                    bool attend = Convert.ToBoolean(newread2["attend"]);
                    if (attend)
                    {
                        dataGridView2.Rows[i].Cells[2].Value = "+";
                    }
                    DateTime late_date = DateTime.Parse(stroke[0]);
                    late_date = late_date.AddDays(7);
                    TimeSpan ts = DateTime.Today - late_date;
                    int days_left = ts.Days;
                    if (days_left > 7)
                    {
                        dataGridView2.Rows[i].Cells[4].Value = "+";
                    }
                }
                newread2.Close();
                newread2 = connect2.GetDBData("select * from classes_progress where st_zk_no='" + zk + "' and course_id='" + crs + "' and classes_id='" + lab_id[i] + "';");
                if (newread2.Read())
                {
                    int mark = Convert.ToInt32(newread2["mark"]);
                    dataGridView2.Rows[i].Cells[3].Value = mark;
                }
                newread2.Close();

                i++;
            }
            newread.Close();
            newread = connect.GetDBData("select * from classes where course_id='" + crs + "' and classes_type_name='Рубежный контроль';");
            lab_no = null;
            lab_id = null;
            i = 0;
            while (newread.Read())
            {
                Array.Resize(ref lab_no, i + 1);
                lab_no[i] = Convert.ToInt32(newread["number"]);
                Array.Resize(ref lab_id, i + 1);
                lab_id[i] = Convert.ToInt32(newread["id"]);
                dataGridView3.Rows.Add(lab_no[i].ToString());
                string[] stroke = newread["date"].ToString().Split(new string[] { " " }, StringSplitOptions.RemoveEmptyEntries);
                string s = stroke[0];
                dataGridView3.Rows[i].Cells[1].Value = stroke[0];
                DB_connect connect2 = new DB_connect(ip, db, user, pass);
                MySqlDataReader newread2 = connect2.GetDBData("select * from attendance where st_zk_no='" + zk + "' and course_id='" + crs + "' and classes_id='" + lab_id[i] + "';");
                if (newread2.Read())
                {
                    bool attend = Convert.ToBoolean(newread2["attend"]);
                    if (attend)
                    {
                        dataGridView3.Rows[i].Cells[2].Value = "+";
                    }
                    DateTime late_date = DateTime.Parse(stroke[0]);
                    late_date = late_date.AddDays(7);
                    TimeSpan ts = DateTime.Today - late_date;
                    int days_left = ts.Days;
                    if (days_left > 7)
                    {
                        dataGridView3.Rows[i].Cells[4].Value = "+";
                    }
                }
                newread2.Close();
                newread2 = connect2.GetDBData("select * from classes_progress where st_zk_no='" + zk + "' and course_id='" + crs + "' and classes_id='" + lab_id[i] + "';");
                if (newread2.Read() && !(newread2["mark"] == System.DBNull.Value))
                {
                    int mark = Convert.ToInt32(newread2["mark"]);
                    dataGridView3.Rows[i].Cells[3].Value = mark;
                }
                newread2.Close();

                i++;
            }
            newread.Close();
            newread = connect.GetDBData("select * from classes where course_id='" + crs + "' and classes_type_name='Домашнее задание';");
            lab_no = null;
            lab_id = null;
            i = 0;
            while (newread.Read())
            {
                Array.Resize(ref lab_no, i + 1);
                lab_no[i] = Convert.ToInt32(newread["number"]);
                Array.Resize(ref lab_id, i + 1);
                lab_id[i] = Convert.ToInt32(newread["id"]);
                dataGridView4.Rows.Add(lab_no[i].ToString());
                string[] stroke = newread["date"].ToString().Split(new string[] { " " }, StringSplitOptions.RemoveEmptyEntries);
                string s = stroke[0];
                dataGridView4.Rows[i].Cells[1].Value = stroke[0];
                DB_connect connect2 = new DB_connect(ip, db, user, pass);
                MySqlDataReader newread2 = connect2.GetDBData("select * from attendance where st_zk_no='" + zk + "' and course_id='" + crs + "' and classes_id='" + lab_id[i] + "';");
                if (newread2.Read())
                {
                    bool attend = Convert.ToBoolean(newread2["attend"]);
                    if (attend)
                    {
                        dataGridView4.Rows[i].Cells[2].Value = "+";
                    }
                    DateTime late_date = DateTime.Parse(stroke[0]);
                    late_date = late_date.AddDays(7);
                    TimeSpan ts = DateTime.Today - late_date;
                    int days_left = ts.Days;
                    if (days_left > 7)
                    {
                        dataGridView4.Rows[i].Cells[4].Value = "+";
                    }
                }
                newread2.Close();
                newread2 = connect2.GetDBData("select * from classes_progress where st_zk_no='" + zk + "' and course_id='" + crs + "' and classes_id='" + lab_id[i] + "';");
                if (newread2.Read() && !(newread2["mark"] == System.DBNull.Value))
                {
                    int mark = Convert.ToInt32(newread2["mark"]);
                    dataGridView4.Rows[i].Cells[3].Value = mark;
                }
                newread2.Close();

                i++;
            }
            newread.Close();
        }

        private void StudProgress_Shown(object sender, EventArgs e)
        {
            Upd();
        }
    }
}



StudSched.cs
using MySql.Data.MySqlClient;
using System;
using System.Windows.Forms;

namespace Электронный_университет
{
    public partial class StudSched : Form
    {
        public StudSched(string name, string group_name, string ip, string db, string user, string pass)
        {
            InitializeComponent();
            this.MaximizeBox = false;
            this.FormBorderStyle = FormBorderStyle.FixedDialog;
            this.group_name = group_name;
            this.ip = ip;
            this.db = db;
            this.user = user;
            this.pass = pass;
            con = new DB_connect(ip, db, user, pass);
            string today = DateTime.Today.Year + "-" + DateTime.Today.Month + "-" + DateTime.Today.Day;
            reader = con.GetDBData("select * from week where date_start<='" + today + "' and date_finish>='" + today + "';");
            reader.Read();
            week = Convert.ToInt32(reader["week_no"]);
            reader.Close();
            label1.Text = name;
        }

        string group_name;
        string ip;
        string db;
        string user;
        string pass;
        string login;
        int week;
        DB_connect con;
        MySqlDataReader reader;

        private void Upd(int week_no)
        {
            dataGridView1.Rows.Clear();
            reader = con.GetDBData("select * from week where week_no='" + week_no + "';");
            if (reader.Read())
            {
                string[] d_s = reader["date_start"].ToString().Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);
                string[] d_f = reader["date_finish"].ToString().Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);
                textBox1.Text = d_s[0];
                textBox2.Text = d_f[0];
                reader.Close();
                int nechet;
                if (week_no % 2 == 0)
                {
                    nechet = 2;
                }
                else
                {
                    nechet = 1;
                }
                reader = con.GetDBData("select * from pairs");
                while (reader.Read())
                {
                    dataGridView1.Rows.Add(reader["pair_no"] + ": " + reader["time_start"] + "-" + reader["time_finish"]);
                }
                for (int i = 1; i < 7; i++)
                {
                    DB_connect con2 = new DB_connect(ip, db, user, pass);
                    MySqlDataReader reader2 = con2.GetDBData("select * from schedule_on_week where (parity='" + nechet + "' or parity='0') and day_of_week='" + i + "' and groups_name='" + group_name + "';");
                    while (reader2.Read())
                    {
                        int prof_id = Convert.ToInt32(reader2["prof_id"]);
                        string prof_name = "";
                        DB_connect con4 = new DB_connect(ip, db, user, pass);
                        MySqlDataReader reader4 = con4.GetDBData("select * from professor where id='" + prof_id + "';");
                        if (reader4.Read())
                        {
                            prof_name = reader4["name"].ToString();
                        }
                        reader4.Close();
                        int pair_no = Convert.ToInt32(reader2["pair_no"]);
                        string classes_type_name = reader2["classes_type_name"].ToString();
                        int course_id = Convert.ToInt32(reader2["course_id"]);
                        int auditory = Convert.ToInt32(reader2["auditory_no"]);
                        DB_connect con3 = new DB_connect(ip, db, user, pass);
                        MySqlDataReader reader3 = con3.GetDBData("select * from course where id='" + course_id + "';");
                        reader3.Read();
                        string course_name = reader3["name"].ToString();
                        reader3.Close();
                        string str = course_name + "\r\n" + prof_name + "\r\n" + classes_type_name + "\r\n" + auditory;
                        dataGridView1.Rows[pair_no - 1].Cells[i].Value = str;
                        dataGridView1.Rows[pair_no - 1].Height = 65;
                    }
                }
            }
            reader.Close();
        }

        private void StudSched_Shown(object sender, EventArgs e)
        {
            Upd(week);
        }

        private void label2_Click(object sender, EventArgs e)
        {
            week -= 1;
            Upd(week);
        }

        private void label4_Click(object sender, EventArgs e)
        {
            week += 1;
            Upd(week);
        }
    }
}



db_func.cs
using MySql.Data.MySqlClient;
using System;
using System.Windows.Forms;

namespace Электронный_университет
{
    public class DB_connect
    {
        public DB_connect(string ip, string db, string user, string pass)
        {
            myConnectionString = "Database=" + db + ";Data Source=" + ip + ";User Id=" + user + ";Password=" + pass;
            myConnection = new MySqlConnection(myConnectionString);
            try
            {
                myConnection.Open();
            }
            catch (Exception ex)
            {

            }
        }
        MySqlConnection myConnection = null;
        public string role = null;
        public string myConnectionString;

        public bool CheckLogPass(string log, string pass)
        {
            try
            {
                string sql = "SELECT COUNT(*) FROM users WHERE login='" + log + "' AND password='" + pass + "';";
                MySqlCommand com = new MySqlCommand(sql, myConnection);
                object scalar = com.ExecuteScalar();
                int count = Convert.ToInt32(scalar);
                if (count == 1)
                {
                    return true;
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show("Невозможно установить соединение с сервером!\r\n\r\n", ex.ToString());
            }
            return false;
        }

        public string CheckRole(string log)
        {
            string sql = "SELECT COUNT(*) FROM professor WHERE login='" + log + "';";
            MySqlCommand com = new MySqlCommand(sql, myConnection);
            object scalar = com.ExecuteScalar();
            int count = Convert.ToInt32(scalar);
            if (count == 1)
            {
                role = "prof";
                return role;
            }
            role = "stud";
            return role;
        }

        public MySqlDataReader GetDBData(string sql)
        {
            MySqlCommand command = new MySqlCommand();
            command.CommandText = sql;
            command.Connection = myConnection;
            MySqlDataReader reader = command.ExecuteReader();
            return reader;
        }

        public void Close()
        {
            myConnection.Close();
        }
    }
}



ini_func.cs
using System;
using System.IO;
using System.Windows.Forms;
using System.Text;

namespace Электронный_университет
{
    class ini_func
    {
        public string[][] ReadIni()
        { 
            string name = "servers.ini";
            FileInfo fle = new FileInfo(name);
            String[][] fitems = null;
            if (fle.Exists)
            {
                string str = null;
                StreamReader strr = new StreamReader(name, Encoding.UTF8);
                while (!strr.EndOfStream)
                {
                    str += strr.ReadLine();
                }
                String[] stroke = str.Split(new char[] { ';' }, StringSplitOptions.RemoveEmptyEntries);
                for (int i = 0; i < stroke.Length; i++)
                {
                    String[] items = null;
                    items = stroke[i].Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);
                    Array.Resize(ref fitems, i + 1);
                    for (int j = 0; j < items.Length; j++)
                    {
                        Array.Resize(ref fitems[i], j + 1);
                        fitems[i][j] = items[j];
                    }
                }
                strr.Close();
            }
            else fle.Create();

            return fitems;
        }

        public bool FormOpened(Form form)
        {
            foreach (Form f in Application.OpenForms)
            {
                if (f.Name == form.Name)
                {
                    return true;
                }
            }
            return false;
        }
    }
}
